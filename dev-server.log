
> snap-to-health@0.1.0 dev
> next dev

  â–² Next.js 14.2.28
  - Local:        http://localhost:3000
  - Environments: .env.local
  - Experiments (use with caution):
    Â· externalDir

 âœ“ Starting...
 âœ“ Ready in 936ms
 â—‹ Compiling /api/analyzeImage ...
 âœ“ Compiled /api/analyzeImage in 599ms (395 modules)
âœ… OpenAI client initialized successfully.
âœ… Firebase private key validation passed
Processing Firebase private key (base64 length: 2272 chars)
Initializing Firebase Admin with: 
        - Project ID: snaphealth-39b14
        - Client Email: fireb...
        - Private Key: Successfully decoded (PEM format)
        - Storage Bucket: snaphealth-39b14.appspot.com
âœ… Firebase Admin initialized successfully
[analyzeImage] handler start
ğŸ“¥ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Analyzing image - request received
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Starting stage: check-ocr-config
âœ… [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Completed stage: check-ocr-config
â±ï¸ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Stage check-ocr-config took 1ms
ğŸ“‹ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] OCR configuration: {"enabled":true,"confidenceThreshold":0.7,"segmentationEnabled":true,"serverless":false}
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Starting stage: extract-request-data
ğŸ“„ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Content-Type: multipart/form-data; boundary=------------------------S0wvIDD486gE8Dv8GlvrkD
ğŸ“ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Parsing multipart form data
ğŸ“‹ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Form data keys: [ 'image', 'healthGoal' ]
âœ… [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Completed stage: extract-request-data
â±ï¸ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Stage extract-request-data took 2ms
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Starting stage: extract-base64-image
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Extracting base64 from image
ğŸ“ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Image file info: {
  "type": "object",
  "constructor": "File",
  "isNull": false,
  "isUndefined": false,
  "hasProperties": [],
  "isFormDataEntryValue": true
}
ğŸ“„ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] File name: test.jpg
ğŸ“ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] File details - Type: image/jpeg, Size: 660 bytes
ğŸ“Š [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] arrayBuffer returned 660 bytes
âœ“ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Successfully converted using arrayBuffer (660 bytes)
ğŸ“Š [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Buffer created with size: 660 bytes
ğŸ“Š [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Generated base64 string length: 880 chars
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Using MIME type: image/jpeg
âœ… [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Successfully extracted base64 image (903 total chars)
â±ï¸ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] extractBase64Image: 0.239ms
âœ… [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Base64 extraction successful (903 chars)
âœ… [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Completed stage: extract-base64-image
â±ï¸ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Stage extract-base64-image took 0ms
â±ï¸ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Setting global timeout: 30000ms (30 seconds)
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Starting stage: check-nutritionix-credentials
Checking Nutritionix credentials...
ğŸ“‹ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Nutritionix credential check: Success: true, App ID: valid, API Key: present
âœ… [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Completed stage: check-nutritionix-credentials
â±ï¸ [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Stage check-nutritionix-credentials took 180ms
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Starting stage: run-ocr
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Running OCR to extract text from image
ğŸ” [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Starting OCR text extraction
âœ… [a70fdf5a-ef6b-4eb4-9f69-76688fb9eb51] Successfully imported tesseract.js
 âœ“ Compiled in 15ms
[?25h
