
> snap-to-health@0.1.0 dev
> next dev

  â–² Next.js 14.2.28
  - Local:        http://localhost:3000
  - Environments: .env.local
  - Experiments (use with caution):
    Â· externalDir

 âœ“ Starting...
 âœ“ Ready in 971ms
 âœ“ Compiled /api/analyzeImage in 272ms (395 modules)
âœ… OpenAI client initialized successfully.
âœ… Firebase private key validation passed
Processing Firebase private key (base64 length: 2272 chars)
Initializing Firebase Admin with: 
        - Project ID: snaphealth-39b14
        - Client Email: fireb...
        - Private Key: Successfully decoded (PEM format)
        - Storage Bucket: snaphealth-39b14.appspot.com
âœ… Firebase Admin initialized successfully
[analyzeImage] handler start
ğŸ“¥ [dfcef864-c719-4a0c-89f7-604aa04edd67] Analyzing image - request received
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: check-ocr-config
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: check-ocr-config
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage check-ocr-config took 1ms
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] OCR configuration: {"enabled":true,"confidenceThreshold":0.7,"segmentationEnabled":true,"serverless":false}
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: extract-request-data
ğŸ“„ [dfcef864-c719-4a0c-89f7-604aa04edd67] Content-Type: multipart/form-data; boundary=------------------------kC8d5xFc2Yok71d9TXqBRY
ğŸ“ [dfcef864-c719-4a0c-89f7-604aa04edd67] Parsing multipart form data
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Form data keys: [ 'image', 'healthGoal' ]
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: extract-request-data
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage extract-request-data took 2ms
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: extract-base64-image
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Extracting base64 from image
ğŸ“ [dfcef864-c719-4a0c-89f7-604aa04edd67] Image file info: {
  "type": "object",
  "constructor": "File",
  "isNull": false,
  "isUndefined": false,
  "hasProperties": [],
  "isFormDataEntryValue": true
}
ğŸ“„ [dfcef864-c719-4a0c-89f7-604aa04edd67] File name: test.jpg
ğŸ“ [dfcef864-c719-4a0c-89f7-604aa04edd67] File details - Type: image/jpeg, Size: 660 bytes
ğŸ“Š [dfcef864-c719-4a0c-89f7-604aa04edd67] arrayBuffer returned 660 bytes
âœ“ [dfcef864-c719-4a0c-89f7-604aa04edd67] Successfully converted using arrayBuffer (660 bytes)
ğŸ“Š [dfcef864-c719-4a0c-89f7-604aa04edd67] Buffer created with size: 660 bytes
ğŸ“Š [dfcef864-c719-4a0c-89f7-604aa04edd67] Generated base64 string length: 880 chars
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Using MIME type: image/jpeg
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Successfully extracted base64 image (903 total chars)
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] extractBase64Image: 0.268ms
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Base64 extraction successful (903 chars)
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: extract-base64-image
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage extract-base64-image took 0ms
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Setting global timeout: 30000ms (30 seconds)
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: check-nutritionix-credentials
Checking Nutritionix credentials...
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Nutritionix credential check: Success: true, App ID: valid, API Key: present
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: check-nutritionix-credentials
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage check-nutritionix-credentials took 252ms
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: run-ocr
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Running OCR to extract text from image
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting OCR text extraction
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Successfully imported tesseract.js
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] OCR timeout reached after 5000ms
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Using fallback text due to OCR timeout: "Salad with grilled chicken, tomatoes, and avocado...."
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] OCR successful, extracted 88 characters
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Extracted text: "Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water."
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: run-ocr
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage run-ocr took 5004ms
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: analyze-text
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Analyzing extracted text to identify meal components
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting text-only meal analysis
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Extracting food items from text (88 chars)
ğŸ“ [dfcef864-c719-4a0c-89f7-604aa04edd67] Cleaned text: "Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water."
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Extracted 3 food items using basic splitting
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Found 3 unique food items
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Extracted food items: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Extracted 3 food items
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Getting nutrition data for: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ”‘ [dfcef864-c719-4a0c-89f7-604aa04edd67] Nutritionix API credentials available: true
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Successfully retrieved nutrition data for 5 food items
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] getNutritionData: 185.691ms
ğŸ’¬ [dfcef864-c719-4a0c-89f7-604aa04edd67] Generating feedback based on health goals and dietary preferences
ğŸ’¡ [dfcef864-c719-4a0c-89f7-604aa04edd67] Generating suggestions based on analysis results
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Text-only meal analysis completed successfully
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Text analysis successful
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Identified meal: This meal contains Salad with grilled chicken, tomatoes and avocado. Side of brown rice. A glass of water.. It provides approximately 755 calories.
ğŸ“‹ [dfcef864-c719-4a0c-89f7-604aa04edd67] Identified ingredients: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: analyze-text
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage analyze-text took 187ms
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: get-nutrition-data
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Getting nutrition data for identified ingredients
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Getting nutrition data for: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ”‘ [dfcef864-c719-4a0c-89f7-604aa04edd67] Nutritionix API credentials available: true
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Successfully retrieved nutrition data for 5 food items
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] getNutritionData: 97.5ms
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Nutrition data retrieved successfully
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: get-nutrition-data
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage get-nutrition-data took 98ms
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Starting stage: create-final-analysis
ğŸ” [dfcef864-c719-4a0c-89f7-604aa04edd67] Creating nutrient analysis with 0 health goals
âœ… [dfcef864-c719-4a0c-89f7-604aa04edd67] Completed stage: create-final-analysis
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] Stage create-final-analysis took 0ms
ğŸ“Š [dfcef864-c719-4a0c-89f7-604aa04edd67] Analysis diagnostics completed:
ğŸ“Š [dfcef864-c719-4a0c-89f7-604aa04edd67] Total duration: 5544ms
ğŸ“Š [dfcef864-c719-4a0c-89f7-604aa04edd67] Overall success: true
ğŸ“Š [dfcef864-c719-4a0c-89f7-604aa04edd67] Summary: Analysis completed successfully in 5544ms through 8 stages
ğŸ“¤ [dfcef864-c719-4a0c-89f7-604aa04edd67] Analysis complete in 5544ms
ğŸ“ˆ [dfcef864-c719-4a0c-89f7-604aa04edd67] Success: true, Fallback: false
â±ï¸ [dfcef864-c719-4a0c-89f7-604aa04edd67] analyzeImage POST: 5.544s
[analyzeImage] returning SUCCESS
 POST /api/analyzeImage 200 in 6150ms
  â–² Next.js 14.2.28
  - Local:        http://localhost:3000
  - Environments: .env.local
  - Experiments (use with caution):
    Â· externalDir

 âœ“ Starting...
 âœ“ Ready in 929ms
  â–² Next.js 14.2.28
  - Local:        http://localhost:3000
  - Environments: .env.local
  - Experiments (use with caution):
    Â· externalDir

 âœ“ Starting...
 âœ“ Ready in 971ms
  â–² Next.js 14.2.28
  - Local:        http://localhost:3000
  - Environments: .env.local

 âœ“ Starting...
 âœ“ Ready in 930ms
  â–² Next.js 14.2.28
  - Local:        http://localhost:3000
  - Environments: .env.local
  - Experiments (use with caution):
    Â· externalDir

 âœ“ Starting...
 âœ“ Ready in 1035ms
 â—‹ Compiling /api/analyzeImage ...
 âœ“ Compiled /api/analyzeImage in 617ms (395 modules)
âœ… OpenAI client initialized successfully.
âœ… Firebase private key validation passed
Processing Firebase private key (base64 length: 2272 chars)
Initializing Firebase Admin with: 
        - Project ID: snaphealth-39b14
        - Client Email: fireb...
        - Private Key: Successfully decoded (PEM format)
        - Storage Bucket: snaphealth-39b14.appspot.com
âœ… Firebase Admin initialized successfully
[analyzeImage] handler start
ğŸ“¥ [6e32196e-227c-433e-8e33-5d561f42cf94] Analyzing image - request received
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: check-ocr-config
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: check-ocr-config
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage check-ocr-config took 0ms
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] OCR configuration: {"enabled":true,"confidenceThreshold":0.7,"segmentationEnabled":true,"serverless":false}
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: extract-request-data
ğŸ“„ [6e32196e-227c-433e-8e33-5d561f42cf94] Content-Type: multipart/form-data; boundary=------------------------3HR8W6fxdWMKQAaZvQ3DIb
ğŸ“ [6e32196e-227c-433e-8e33-5d561f42cf94] Parsing multipart form data
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Form data keys: [ 'image', 'healthGoal' ]
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: extract-request-data
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage extract-request-data took 3ms
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: extract-base64-image
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Extracting base64 from image
ğŸ“ [6e32196e-227c-433e-8e33-5d561f42cf94] Image file info: {
  "type": "object",
  "constructor": "File",
  "isNull": false,
  "isUndefined": false,
  "hasProperties": [],
  "isFormDataEntryValue": true
}
ğŸ“„ [6e32196e-227c-433e-8e33-5d561f42cf94] File name: test.jpg
ğŸ“ [6e32196e-227c-433e-8e33-5d561f42cf94] File details - Type: image/jpeg, Size: 660 bytes
ğŸ“Š [6e32196e-227c-433e-8e33-5d561f42cf94] arrayBuffer returned 660 bytes
âœ“ [6e32196e-227c-433e-8e33-5d561f42cf94] Successfully converted using arrayBuffer (660 bytes)
ğŸ“Š [6e32196e-227c-433e-8e33-5d561f42cf94] Buffer created with size: 660 bytes
ğŸ“Š [6e32196e-227c-433e-8e33-5d561f42cf94] Generated base64 string length: 880 chars
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Using MIME type: image/jpeg
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Successfully extracted base64 image (903 total chars)
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] extractBase64Image: 0.208ms
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Base64 extraction successful (903 chars)
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: extract-base64-image
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage extract-base64-image took 0ms
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Setting global timeout: 30000ms (30 seconds)
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: check-nutritionix-credentials
Checking Nutritionix credentials...
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Nutritionix credential check: Success: true, App ID: valid, API Key: present
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: check-nutritionix-credentials
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage check-nutritionix-credentials took 195ms
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: run-ocr
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Running OCR to extract text from image
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting OCR text extraction
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Successfully imported tesseract.js
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] OCR timeout reached after 5000ms
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Using fallback text due to OCR timeout: "Salad with grilled chicken, tomatoes, and avocado...."
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] OCR successful, extracted 88 characters
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Extracted text: "Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water."
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: run-ocr
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage run-ocr took 5003ms
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: analyze-text
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Analyzing extracted text to identify meal components
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting text-only meal analysis
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Extracting food items from text (88 chars)
ğŸ“ [6e32196e-227c-433e-8e33-5d561f42cf94] Cleaned text: "Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water."
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Extracted 3 food items using basic splitting
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Found 3 unique food items
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Extracted food items: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Extracted 3 food items
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Getting nutrition data for: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ”‘ [6e32196e-227c-433e-8e33-5d561f42cf94] Nutritionix API credentials available: true
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Successfully retrieved nutrition data for 5 food items
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] getNutritionData: 210.737ms
ğŸ’¬ [6e32196e-227c-433e-8e33-5d561f42cf94] Generating feedback based on health goals and dietary preferences
ğŸ’¡ [6e32196e-227c-433e-8e33-5d561f42cf94] Generating suggestions based on analysis results
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Text-only meal analysis completed successfully
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Text analysis successful
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Identified meal: This meal contains Salad with grilled chicken, tomatoes and avocado. Side of brown rice. A glass of water.. It provides approximately 755 calories.
ğŸ“‹ [6e32196e-227c-433e-8e33-5d561f42cf94] Identified ingredients: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: analyze-text
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage analyze-text took 213ms
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: get-nutrition-data
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Getting nutrition data for identified ingredients
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Getting nutrition data for: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ”‘ [6e32196e-227c-433e-8e33-5d561f42cf94] Nutritionix API credentials available: true
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Successfully retrieved nutrition data for 5 food items
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] getNutritionData: 107.522ms
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Nutrition data retrieved successfully
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: get-nutrition-data
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage get-nutrition-data took 107ms
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Starting stage: create-final-analysis
ğŸ” [6e32196e-227c-433e-8e33-5d561f42cf94] Creating nutrient analysis with 0 health goals
âœ… [6e32196e-227c-433e-8e33-5d561f42cf94] Completed stage: create-final-analysis
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] Stage create-final-analysis took 0ms
ğŸ“Š [6e32196e-227c-433e-8e33-5d561f42cf94] Analysis diagnostics completed:
ğŸ“Š [6e32196e-227c-433e-8e33-5d561f42cf94] Total duration: 5522ms
ğŸ“Š [6e32196e-227c-433e-8e33-5d561f42cf94] Overall success: true
ğŸ“Š [6e32196e-227c-433e-8e33-5d561f42cf94] Summary: Analysis completed successfully in 5522ms through 8 stages
ğŸ“¤ [6e32196e-227c-433e-8e33-5d561f42cf94] Analysis complete in 5522ms
ğŸ“ˆ [6e32196e-227c-433e-8e33-5d561f42cf94] Success: true, Fallback: false
â±ï¸ [6e32196e-227c-433e-8e33-5d561f42cf94] analyzeImage POST: 5.522s
[analyzeImage] returning SUCCESS
 POST /api/analyzeImage 200 in 6481ms
 âœ“ Compiled in 29ms
 âœ“ Compiled /api/analyzeImage in 272ms (399 modules)
âœ… OpenAI client initialized successfully.
[analyzeImage] handler start
ğŸ“¥ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Analyzing image - request received
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: check-ocr-config
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: check-ocr-config
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage check-ocr-config took 0ms
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] OCR configuration: {"enabled":true,"confidenceThreshold":0.7,"segmentationEnabled":true,"serverless":false}
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: extract-request-data
ğŸ“„ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Content-Type: multipart/form-data; boundary=------------------------JXRaDVTlYDVFgAwYEhHbUg
ğŸ“ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Parsing multipart form data
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Form data keys: [ 'image', 'healthGoal' ]
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: extract-request-data
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage extract-request-data took 1ms
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: extract-base64-image
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Extracting base64 from image
ğŸ“ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Image file info: {
  "type": "object",
  "constructor": "File",
  "isNull": false,
  "isUndefined": false,
  "hasProperties": [],
  "isFormDataEntryValue": true
}
ğŸ“„ [f108f690-2f1e-4585-bc67-3582d84e8b7d] File name: test.jpg
ğŸ“ [f108f690-2f1e-4585-bc67-3582d84e8b7d] File details - Type: image/jpeg, Size: 660 bytes
ğŸ“Š [f108f690-2f1e-4585-bc67-3582d84e8b7d] arrayBuffer returned 660 bytes
âœ“ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Successfully converted using arrayBuffer (660 bytes)
ğŸ“Š [f108f690-2f1e-4585-bc67-3582d84e8b7d] Buffer created with size: 660 bytes
ğŸ“Š [f108f690-2f1e-4585-bc67-3582d84e8b7d] Generated base64 string length: 880 chars
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Using MIME type: image/jpeg
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Successfully extracted base64 image (903 total chars)
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] extractBase64Image: 0.109ms
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Base64 extraction successful (903 chars)
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: extract-base64-image
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage extract-base64-image took 0ms
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Setting global timeout: 30000ms (30 seconds)
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: check-nutritionix-credentials
Checking Nutritionix credentials...
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Nutritionix credential check: Success: true, App ID: valid, API Key: present
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: check-nutritionix-credentials
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage check-nutritionix-credentials took 139ms
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: run-ocr
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Running OCR to extract text from image
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting OCR text extraction
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Successfully imported tesseract.js
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] OCR timeout reached after 5000ms
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Using fallback text due to OCR timeout: "Salad with grilled chicken, tomatoes, and avocado...."
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] OCR successful, extracted 88 characters
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Extracted text: "Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water."
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: run-ocr
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage run-ocr took 5002ms
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: analyze-text
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Analyzing extracted text to identify meal components
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting text-only meal analysis
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Extracting food items from text (88 chars)
ğŸ“ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Cleaned text: "Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water."
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Extracted 3 food items using basic splitting
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Found 3 unique food items
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Extracted food items: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Extracted 3 food items
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Getting nutrition data for: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
ğŸ”‘ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Nutritionix API credentials available: true
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Successfully retrieved nutrition data for 5 food items
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] getNutritionData: 241.474ms
ğŸ’¬ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Generating feedback based on health goals and dietary preferences
ğŸ’¡ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Generating suggestions based on analysis results
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Text-only meal analysis completed successfully
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Text analysis successful
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Identified meal: This meal contains Salad with grilled chicken, tomatoes and avocado. Side of brown rice. A glass of water.. It provides approximately 755 calories.
ğŸ“‹ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Identified ingredients: Salad with grilled chicken, tomatoes, avocado. Side of brown rice. A glass of water.
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: analyze-text
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage analyze-text took 242ms
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: get-nutrition-data
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Getting nutrition data for identified ingredients
[analyzeImage] OCR text: Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water.
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Getting nutrition data for: Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water.
ğŸ”‘ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Nutritionix API credentials available: true
[GPT Fallback] Generating nutrition data for: "Salad with grilled chicken, tomatoes, and avocado. Side of brown rice. A glass of water."
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Successfully retrieved nutrition data for 5 food items
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] getNutritionData: 170.528ms
[analyzeImage] using path: nutritionix
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: get-nutrition-data
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage get-nutrition-data took 172ms
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Starting stage: create-final-analysis
ğŸ” [f108f690-2f1e-4585-bc67-3582d84e8b7d] Creating nutrient analysis with 0 health goals
âœ… [f108f690-2f1e-4585-bc67-3582d84e8b7d] Completed stage: create-final-analysis
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Stage create-final-analysis took 0ms
ğŸ“Š [f108f690-2f1e-4585-bc67-3582d84e8b7d] Analysis diagnostics completed:
ğŸ“Š [f108f690-2f1e-4585-bc67-3582d84e8b7d] Total duration: 5558ms
ğŸ“Š [f108f690-2f1e-4585-bc67-3582d84e8b7d] Overall success: true
ğŸ“Š [f108f690-2f1e-4585-bc67-3582d84e8b7d] Summary: Analysis completed successfully in 5558ms through 8 stages
ğŸ“¤ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Analysis complete in 5558ms
ğŸ“ˆ [f108f690-2f1e-4585-bc67-3582d84e8b7d] Success: true, Fallback: false
â±ï¸ [f108f690-2f1e-4585-bc67-3582d84e8b7d] analyzeImage POST: 5.558s
[analyzeImage] returning SUCCESS
 POST /api/analyzeImage 200 in 5875ms
[GPT Fallback] Successfully generated nutrition data with 8 nutrients
 âœ“ Compiled in 545ms (601 modules)
 âœ“ Compiled in 17ms
 âœ“ Compiled /api/analyzeImage in 107ms (386 modules)
[analyzeImage] handler start
[analyzeImage] Content-Type: multipart/form-data; boundary=------------------------htxR25HYsB55hHcMjHweIN
[analyzeImage] Form data keys: [ 'image', 'healthGoal' ]
ğŸ“ [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Image file info: {
  "type": "object",
  "constructor": "File",
  "isNull": false,
  "isUndefined": false,
  "hasProperties": [],
  "isFormDataEntryValue": true
}
ğŸ“„ [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] File name: test.jpg
ğŸ“ [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] File details - Type: image/jpeg, Size: 660 bytes
ğŸ“Š [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] arrayBuffer returned 660 bytes
âœ“ [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Successfully converted using arrayBuffer (660 bytes)
ğŸ“Š [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Buffer created with size: 660 bytes
ğŸ“Š [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Generated base64 string length: 880 chars
ğŸ” [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Using MIME type: image/jpeg
âœ… [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Successfully extracted base64 image (903 total chars)
â±ï¸ [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] extractBase64Image: 0.534ms
[analyzeImage] Extracted base64 image (903 chars)
[analyzeImage] Cache miss for Test_34e6e7653e7e681fc256173b605ab5fe, processing...
[analyzeImage] Running OCR to extract text from image
ğŸ” [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Starting OCR text extraction
âœ… [b1009ea9-d08f-45bb-ae58-f4ce3fafb4b6] Successfully imported tesseract.js
 POST /api/analyzeImage 200 in 172452ms
